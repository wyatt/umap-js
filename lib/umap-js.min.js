!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var o in r)("object"==typeof exports?exports:t)[o]=r[o]}}(self,(()=>(()=>{"use strict";var t={544:(t,e,r)=>{r.r(e),r.d(e,{default:()=>a});const o=Object.prototype.toString;function n(t){const e=o.call(t);return e.endsWith("Array]")&&!e.includes("Big")}const i=Object.prototype.toString;const s=Object.prototype.toString;function a(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!n(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){const e=s.call(t);return e.endsWith("Array]")&&!e.includes("Big")}(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,i=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=o||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[o],h=o+1;h<i;h++)t[h]<a&&(a=t[h]);return a}(t),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!function(t){const e=i.call(t);return e.endsWith("Array]")&&!e.includes("Big")}(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[o],h=o+1;h<s;h++)t[h]>a&&(a=t[h]);return a}(t);if(o===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=r.min,u=void 0===h?r.autoMinMax?o:0:h,l=r.max,c=void 0===l?r.autoMinMax?a:1:l;if(u>=c)throw new RangeError("min option must be smaller than max option");for(var f=(c-u)/(a-o),m=0;m<t.length;m++)e[m]=(t[m]-o)*f+u;return e}},142:(t,e,r)=>{r.r(e),r.d(e,{default:()=>l});const o=Object.prototype.toString;function n(t){return o.call(t).endsWith("Array]")}function i(t,e,r){let o=0;const n=r(e);for(let e=0;e<t.x.length;e++)o+=Math.abs(t.y[e]-n(t.x[e]));return o}var s=r(673);s.y3,s.jy,s.oN,s.Hc,s.cg,s.hj,s.LU,s.Tb;const a=s.uq,h=(s.Zm,s.Dq,s.__,s.q0,s.lh,s.pI,s.zC,s.zg,s.g6,s.OL,s.ks,s.QR,s.jp,s.mk,s.W2,s.l,s.KY,s.dv,s.BR,s.Wu,s.uq,s.uq,s.a4,s.DI);function u(t,e,r,o,n){let i=r*o*o,s=a.eye(e.length,e.length,i);const u=n(e);let l=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)l[e]=u(t.x[e]);let c=function(t,e,r,o,n){const i=r.length,s=t.x.length;let h=new Array(i);for(let a=0;a<i;a++){h[a]=new Array(s);let i=r.slice();i[a]+=o;let u=n(i);for(let r=0;r<s;r++)h[a][r]=e[r]-u(t.x[r])}return new a(h)}(t,l,e,o,n),f=function(t,e){const r=t.x.length;let o=new Array(r);for(let n=0;n<r;n++)o[n]=[t.y[n]-e[n]];return new a(o)}(t,l),m=h(s.add(c.mmul(c.transpose())));return(e=(e=new a([e])).sub(m.mmul(c).mmul(f).mul(o).transpose())).to1DArray()}function l(t,e,r={}){let{maxIterations:o=100,gradientDifference:s=.1,damping:a=0,errorTolerance:h=.01,minValues:l,maxValues:c,initialValues:f}=r;if(a<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!n(t.x)||t.x.length<2||!n(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let m=f||new Array(e.length).fill(1),g=m.length;if(c=c||new Array(g).fill(Number.MAX_SAFE_INTEGER),l=l||new Array(g).fill(Number.MIN_SAFE_INTEGER),c.length!==l.length)throw new Error("minValues and maxValues must be the same size");if(!n(m))throw new Error("initialValues must be an array");let p,d=i(t,m,e),w=d<=h;for(p=0;p<o&&!w;p++){m=u(t,m,a,s,e);for(let t=0;t<g;t++)m[t]=Math.min(Math.max(l[t],m[t]),c[t]);if(d=i(t,m,e),isNaN(d))break;w=d<=h}return{parameterValues:m,parameterError:d,iterations:p}}s.Jo,s.Zi,s.kH,s.LV},673:(t,e,r)=>{var o=r(103),n=r(544);const i=" ".repeat(2),s=" ".repeat(4);function a(t,e={}){const{maxRows:r=15,maxColumns:o=10,maxNumSize:n=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${i}[\n${s}${function(t,e,r,o,n){const{rows:i,columns:a}=t,u=Math.min(i,e),l=Math.min(a,r),c=[];if("auto"===n){n=!1;t:for(let e=0;e<u;e++)for(let r=0;r<l;r++)if(t.get(e,r)<0){n=!0;break t}}for(let e=0;e<u;e++){let r=[];for(let i=0;i<l;i++)r.push(h(t.get(e,i),o,n));c.push(`${r.join(" ")}`)}return l!==a&&(c[c.length-1]+=` ... ${a-r} more columns`),u!==i&&c.push(`... ${i-e} more rows`),c.join(`\n${s}`)}(t,r,o,n,a)}\n${i}]\n${i}rows: ${t.rows}\n${i}columns: ${t.columns}\n}`}function h(t,e,r){return(t>=0&&r?` ${u(t,e-1)}`:u(t,e)).padEnd(e)}function u(t,e){let r=t.toString();if(r.length<=e)return r;let o=t.toFixed(e);if(o.length>e&&(o=t.toFixed(Math.max(0,e-(o.length-e)))),o.length<=e&&!o.startsWith("0.000")&&!o.startsWith("-0.000"))return o;let n=t.toExponential(e);return n.length>e&&(n=t.toExponential(Math.max(0,e-(n.length-e)))),n.slice(0)}function l(t,e,r){let o=r?t.rows:t.rows-1;if(e<0||e>o)throw new RangeError("Row index out of range")}function c(t,e,r){let o=r?t.columns:t.columns-1;if(e<0||e>o)throw new RangeError("Column index out of range")}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function m(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function g(t,e){if(!o.isAnyArray(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}function p(t,e){if(!o.isAnyArray(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}function d(t,e,r,o,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(y("startRow",e),y("endRow",r),y("startColumn",o),y("endColumn",n),e>r||o>n||e<0||e>=t.rows||r<0||r>=t.rows||o<0||o>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function w(t,e=0){let r=[];for(let o=0;o<t;o++)r.push(e);return r}function y(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function v(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class b{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let o=new x(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)o.set(n,t,r[n*e+t]);return o}static rowVector(t){let e=new x(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new x(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new x(t,e)}static ones(t,e){return new x(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:o=Math.random}=r;let n=new x(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)n.set(r,t,o());return n}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:o=0,max:n=1e3,random:i=Math.random}=r;if(!Number.isInteger(o))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(o>=n)throw new RangeError("min must be smaller than max");let s=n-o,a=new x(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=o+Math.round(i()*s);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let o=Math.min(t,e),n=this.zeros(t,e);for(let t=0;t<o;t++)n.set(t,t,r);return n}static diag(t,e,r){let o=t.length;void 0===e&&(e=o),void 0===r&&(r=e);let n=Math.min(o,e,r),i=this.zeros(e,r);for(let e=0;e<n;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new x(r,o);for(let i=0;i<r;i++)for(let r=0;r<o;r++)n.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new this(r,o);for(let i=0;i<r;i++)for(let r=0;r<o;r++)n.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return n}static checkMatrix(t){return b.isMatrix(t)?t:new x(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);t++}return o}isReducedEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(o=!1);t++}return o}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let o=e;for(let n=e;n<t.rows;n++)t.get(n,r)>t.get(o,r)&&(o=n);if(0===t.get(o,r))r++;else{t.swapRows(e,o);let n=t.get(e,r);for(let o=r;o<t.columns;o++)t.set(e,o,t.get(e,o)/n);for(let o=e+1;o<t.rows;o++){let n=t.get(o,r)/t.get(e,r);t.set(o,r,0);for(let i=r+1;i<t.columns;i++)t.set(o,i,t.get(o,i)-t.get(e,i)*n)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,o=r-1;for(;o>=0;)if(0===t.maxRow(o))o--;else{let n=0,i=!1;for(;n<r&&!1===i;)1===t.get(o,n)?i=!0:n++;for(let r=0;r<o;r++){let i=t.get(r,n);for(let s=n;s<e;s++){let e=t.get(r,s)-i*t.get(o,s);t.set(r,s,e)}}o--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let o=new x(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)o.setSubMatrix(this,this.rows*t,this.columns*e);return o}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){l(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return x.rowVector(this.getRow(t))}setRow(t,e){l(this,t),e=f(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){l(this,t),l(this,e);for(let r=0;r<this.columns;r++){let o=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,o)}return this}getColumn(t){c(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return x.columnVector(this.getColumn(t))}setColumn(t,e){c(this,t),e=m(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){c(this,t),c(this,e);for(let r=0;r<this.rows;r++){let o=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,o)}return this}addRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){l(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){c(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){v(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)>t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){v(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)<t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}maxRow(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){l(this,t),v(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)>e&&(e=this.get(t,o),r[1]=o);return r}minRow(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){l(this,t),v(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)<e&&(e=this.get(t,o),r[1]=o);return r}maxColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){c(this,t),v(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)>e&&(e=this.get(o,t),r[0]=o);return r}minColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){c(this,t),v(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)<e&&(e=this.get(o,t),r[0]=o);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){b.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let o=0;o<e.length;o++)r+=e[o]*t[o];return r}mmul(t){t=x.checkMatrix(t);let e=this.rows,r=this.columns,o=t.columns,n=new x(e,o),i=new Float64Array(r);for(let s=0;s<o;s++){for(let e=0;e<r;e++)i[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let o=0;o<r;o++)e+=this.get(t,o)*i[o];n.set(t,s,e)}}return n}strassen2x2(t){t=x.checkMatrix(t);let e=new x(2,2);const r=this.get(0,0),o=t.get(0,0),n=this.get(0,1),i=t.get(0,1),s=this.get(1,0),a=t.get(1,0),h=this.get(1,1),u=t.get(1,1),l=(r+h)*(o+u),c=(s+h)*o,f=r*(i-u),m=h*(a-o),g=(r+n)*u,p=l+m-g+(n-h)*(a+u),d=f+g,w=c+m,y=l-c+f+(s-r)*(o+i);return e.set(0,0,p),e.set(0,1,d),e.set(1,0,w),e.set(1,1,y),e}strassen3x3(t){t=x.checkMatrix(t);let e=new x(3,3);const r=this.get(0,0),o=this.get(0,1),n=this.get(0,2),i=this.get(1,0),s=this.get(1,1),a=this.get(1,2),h=this.get(2,0),u=this.get(2,1),l=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),g=t.get(1,0),p=t.get(1,1),d=t.get(1,2),w=t.get(2,0),y=t.get(2,1),v=t.get(2,2),b=(r-i)*(-f+p),M=(-r+i+s)*(c-f+p),S=(i+s)*(-c+f),E=r*c,N=(-r+h+u)*(c-m+d),R=(-r+h)*(m-d),z=(h+u)*(-c+m),k=(-n+u+l)*(p+w-y),A=(n-l)*(p-y),I=n*w,O=(u+l)*(-w+y),P=(-n+s+a)*(d+w-v),_=(n-a)*(d-v),C=(s+a)*(-w+v),T=E+I+o*g,j=(r+o+n-i-s-u-l)*p+M+S+E+k+I+O,F=E+N+z+(r+o+n-s-a-h-u)*d+I+P+C,D=b+s*(-c+f+g-p-d-w+v)+M+E+I+P+_,V=b+M+S+E+a*y,q=I+P+_+C+i*m,L=E+N+R+u*(-c+m+g-p-d-w+y)+k+A+I,$=k+A+I+O+h*f,U=E+N+R+z+l*v;return e.set(0,0,T),e.set(0,1,j),e.set(0,2,F),e.set(1,0,D),e.set(1,1,V),e.set(1,2,q),e.set(2,0,L),e.set(2,1,$),e.set(2,2,U),e}mmulStrassen(t){t=x.checkMatrix(t);let e=this.clone(),r=e.rows,o=e.columns,n=t.rows,i=t.columns;function s(t,e,r){let o=t.rows,n=t.columns;if(o===e&&n===r)return t;{let o=b.zeros(e,r);return o=o.setSubMatrix(t,0,0),o}}o!==n&&console.warn(`Multiplying ${r} x ${o} and ${n} x ${i} matrix: dimensions do not match.`);let a=Math.max(r,n),h=Math.max(o,i);return e=s(e,a,h),function t(e,r,o,n){if(o<=512||n<=512)return e.mmul(r);o%2==1&&n%2==1?(e=s(e,o+1,n+1),r=s(r,o+1,n+1)):o%2==1?(e=s(e,o+1,n),r=s(r,o+1,n)):n%2==1&&(e=s(e,o,n+1),r=s(r,o,n+1));let i=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),h=e.subMatrix(0,i-1,0,a-1),u=r.subMatrix(0,i-1,0,a-1),l=e.subMatrix(0,i-1,a,e.columns-1),c=r.subMatrix(0,i-1,a,r.columns-1),f=e.subMatrix(i,e.rows-1,0,a-1),m=r.subMatrix(i,r.rows-1,0,a-1),g=e.subMatrix(i,e.rows-1,a,e.columns-1),p=r.subMatrix(i,r.rows-1,a,r.columns-1),d=t(b.add(h,g),b.add(u,p),i,a),w=t(b.add(f,g),u,i,a),y=t(h,b.sub(c,p),i,a),v=t(g,b.sub(m,u),i,a),M=t(b.add(h,l),p,i,a),x=t(b.sub(f,h),b.add(u,c),i,a),S=t(b.sub(l,g),b.add(m,p),i,a),E=b.add(d,v);E.sub(M),E.add(S);let N=b.add(y,M),R=b.add(w,v),z=b.sub(d,w);z.add(y),z.add(x);let k=b.zeros(2*E.rows,2*E.columns);return k=k.setSubMatrix(E,0,0),k=k.setSubMatrix(N,E.rows,0),k=k.setSubMatrix(R,0,E.columns),k=k.setSubMatrix(z,E.rows,E.columns),k.subMatrix(0,o-1,0,n-1)}(e,t=s(t,a,h),a,h)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new x(this.rows,this.columns);for(let t=0;t<this.rows;t++){const i=this.getRow(t);i.length>0&&n(i,{min:e,max:r,output:i}),o.setRow(t,i)}return o}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new x(this.rows,this.columns);for(let t=0;t<this.columns;t++){const i=this.getColumn(t);i.length&&n(i,{min:e,max:r,output:i}),o.setColumn(t,i)}return o}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),o=this.get(e,this.columns-1-r);this.set(e,r,o),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),o=this.get(this.rows-1-r,e);this.set(r,e,o),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=x.checkMatrix(t);let e=this.rows,r=this.columns,o=t.rows,n=t.columns,i=new x(e*o,r*n);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<o;r++)for(let a=0;a<n;a++)i.set(o*s+r,n*e+a,this.get(s,e)*t.get(r,a));return i}kroneckerSum(t){if(t=x.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,o=this.kroneckerProduct(x.eye(r,r)),n=x.eye(e,e).kroneckerProduct(t);return o.add(n)}transpose(){let t=new x(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=M){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=M){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,o){d(this,t,e,r,o);let n=new x(e-t+1,o-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=o;e++)n.set(i-t,e-r,this.get(i,e));return n}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let o=new x(t.length,r-e+1);for(let n=0;n<t.length;n++)for(let i=e;i<=r;i++){if(t[n]<0||t[n]>=this.rows)throw new RangeError(`Row index out of range: ${t[n]}`);o.set(n,i-e,this.get(t[n],i))}return o}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let o=new x(r-e+1,t.length);for(let n=0;n<t.length;n++)for(let i=e;i<=r;i++){if(t[n]<0||t[n]>=this.columns)throw new RangeError(`Column index out of range: ${t[n]}`);o.set(i-e,n,this.get(i,t[n]))}return o}setSubMatrix(t,e,r){if((t=x.checkMatrix(t)).isEmpty())return this;d(this,e,e+t.rows-1,r,r+t.columns-1);for(let o=0;o<t.rows;o++)for(let n=0;n<t.columns;n++)this.set(e+o,r+n,t.get(o,n));return this}selection(t,e){g(this,t),p(this,e);let r=new x(t.length,e.length);for(let o=0;o<t.length;o++){let n=t[o];for(let t=0;t<e.length;t++){let i=e[t];r.set(o,t,this.get(n,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new x(this.rows,this.columns))}static copy(t,e){for(const[r,o,n]of t.entries())e.set(r,o,n);return e}sum(t){switch(t){case"row":return function(t){let e=w(t.rows);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]+=t.get(r,o);return e}(this);case"column":return function(t){let e=w(t.columns);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]+=t.get(r,o);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e+=t.get(r,o);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=w(t.rows,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]*=t.get(r,o);return e}(this);case"column":return function(t){let e=w(t.columns,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]*=t.get(r,o);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e*=t.get(r,o);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!o.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,i=[];for(let s=0;s<o;s++){let o=0,a=0,h=0;for(let e=0;e<n;e++)h=t.get(s,e)-r[s],o+=h,a+=h*h;e?i.push((a-o*o/n)/(n-1)):i.push((a-o*o/n)/n)}return i}(this,r,n);case"column":if(!o.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,i=[];for(let s=0;s<n;s++){let n=0,a=0,h=0;for(let e=0;e<o;e++)h=t.get(e,s)-r[s],n+=h,a+=h*h;e?i.push((a-n*n/o)/(o-1)):i.push((a-n*n/o)/o)}return i}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const o=t.rows,n=t.columns,i=o*n;let s=0,a=0,h=0;for(let e=0;e<o;e++)for(let o=0;o<n;o++)h=t.get(e,o)-r,s+=h,a+=h*h;return e?(a-s*s/i)/(i-1):(a-s*s/i)/i}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!o.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[r])}(this,r),this;case"column":if(!o.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[o])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let o=0;for(let e=0;e<t.columns;e++)o+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(o))}return e}(this);else if(!o.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let o=0;for(let e=0;e<t.rows;e++)o+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(o))}return e}(this);else if(!o.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[o])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let o=0;o<t.columns;o++)for(let n=0;n<t.rows;n++)r+=Math.pow(t.get(n,o),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return a(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function M(t,e){return t-e}b.prototype.klass="Matrix","undefined"!=typeof Symbol&&(b.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),b.random=b.rand,b.randomInt=b.randInt,b.diagonal=b.diag,b.prototype.diagonal=b.prototype.diag,b.identity=b.eye,b.prototype.negate=b.prototype.neg,b.prototype.tensorProduct=b.prototype.kroneckerProduct;class x extends b{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),x.isMatrix(t))this.#t(t.rows,t.columns),x.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!o.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<t;o++){if(r[o].length!==e)throw new RangeError("Inconsistent array dimensions");if(!r[o].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[o]))}this.rows=t,this.columns=e}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return l(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),l(this,t,!0),e=Float64Array.from(f(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){c(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let o=0;o<t;o++)r[o]=this.data[e][o];for(let o=t+1;o<this.columns;o++)r[o-1]=this.data[e][o];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),c(this,t,!0),e=m(this,e);for(let r=0;r<this.rows;r++){const o=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)o[n]=this.data[r][n];for(o[n++]=e[r];n<this.columns+1;n++)o[n]=this.data[r][n-1];this.data[r]=o}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this}}(b,x);class S extends b{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return x.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),x.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=x.copy(t,new x(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new x(t,t);else if(this.#e=new x(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new S(this.diagonalSize);for(const[e,r,o]of this.upperRightEntries())t.set(e,r,o);return t}toMatrix(){return new x(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,o]of t.entries())o||e.push(r);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,o=0,n=0;n<e.length;n++)e[n]=this.get(o,r),++r>=t&&(r=++o);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const o=new S(r);for(let n=0,i=0,s=0;s<e;s++)o.set(n,i,t[s]),++n>=r&&(n=++i);return o}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}S.prototype.klassType="SymmetricMatrix";class E extends S{static isDistanceMatrix(t){return S.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new S(this)}clone(){const t=new E(this.diagonalSize);for(const[e,r,o]of this.upperRightEntries())e!==r&&t.set(e,r,o);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let r=1,o=0,n=0;n<e.length;n++)e[n]=this.get(o,r),++r>=t&&(r=1+ ++o);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const o=new this(r);for(let n=1,i=0,s=0;s<e;s++)o.set(n,i,t[s]),++n>=r&&(n=1+ ++i);return o}}E.prototype.klassSubType="DistanceMatrix";class N extends b{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class R extends N{constructor(t,e,r){g(t,e),p(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class z extends b{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let o=this._calculateIndex(t,e);return this.data[o]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class k extends b{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class A{constructor(t){let e,r,o,n,i,s,a,h,u,l=(t=k.checkMatrix(t)).clone(),c=l.rows,f=l.columns,m=new Float64Array(c),g=1;for(e=0;e<c;e++)m[e]=e;for(h=new Float64Array(c),r=0;r<f;r++){for(e=0;e<c;e++)h[e]=l.get(e,r);for(e=0;e<c;e++){for(u=Math.min(e,r),i=0,o=0;o<u;o++)i+=l.get(e,o)*h[o];h[e]-=i,l.set(e,r,h[e])}for(n=r,e=r+1;e<c;e++)Math.abs(h[e])>Math.abs(h[n])&&(n=e);if(n!==r){for(o=0;o<f;o++)s=l.get(n,o),l.set(n,o,l.get(r,o)),l.set(r,o,s);a=m[n],m[n]=m[r],m[r]=a,g=-g}if(r<c&&0!==l.get(r,r))for(e=r+1;e<c;e++)l.set(e,r,l.get(e,r)/l.get(r,r))}this.LU=l,this.pivotVector=m,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=x.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,o,n,i=t.columns,s=t.subMatrixRow(this.pivotVector,0,i-1),a=e.columns;for(n=0;n<a;n++)for(r=n+1;r<a;r++)for(o=0;o<i;o++)s.set(r,o,s.get(r,o)-s.get(n,o)*e.get(r,n));for(n=a-1;n>=0;n--){for(o=0;o<i;o++)s.set(n,o,s.get(n,o)/e.get(n,n));for(r=0;r<n;r++)for(o=0;o<i;o++)s.set(r,o,s.get(r,o)-s.get(n,o)*e.get(r,n))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let o=0;o<r;o++)e*=t.get(o,o);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new x(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n>e?o.set(n,e,t.get(n,e)):n===e?o.set(n,e,1):o.set(n,e,0);return o}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new x(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n<=e?o.set(n,e,t.get(n,e)):o.set(n,e,0);return o}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function I(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class O{constructor(t){let e,r,o,n,i=(t=k.checkMatrix(t)).clone(),s=t.rows,a=t.columns,h=new Float64Array(a);for(o=0;o<a;o++){let t=0;for(e=o;e<s;e++)t=I(t,i.get(e,o));if(0!==t){for(i.get(o,o)<0&&(t=-t),e=o;e<s;e++)i.set(e,o,i.get(e,o)/t);for(i.set(o,o,i.get(o,o)+1),r=o+1;r<a;r++){for(n=0,e=o;e<s;e++)n+=i.get(e,o)*i.get(e,r);for(n=-n/i.get(o,o),e=o;e<s;e++)i.set(e,r,i.get(e,r)+n*i.get(e,o))}}h[o]=-t}this.QR=i,this.Rdiag=h}solve(t){t=x.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let o,n,i,s,a=t.columns,h=t.clone(),u=e.columns;for(i=0;i<u;i++)for(n=0;n<a;n++){for(s=0,o=i;o<r;o++)s+=e.get(o,i)*h.get(o,n);for(s=-s/e.get(i,i),o=i;o<r;o++)h.set(o,n,h.get(o,n)+s*e.get(o,i))}for(i=u-1;i>=0;i--){for(n=0;n<a;n++)h.set(i,n,h.get(i,n)/this.Rdiag[i]);for(o=0;o<i;o++)for(n=0;n<a;n++)h.set(o,n,h.get(o,n)-h.get(i,n)*e.get(o,i))}return h.subMatrix(0,u-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,o=r.columns,n=new x(o,o);for(t=0;t<o;t++)for(e=0;e<o;e++)t<e?n.set(t,e,r.get(t,e)):t===e?n.set(t,e,this.Rdiag[t]):n.set(t,e,0);return n}get orthogonalMatrix(){let t,e,r,o,n=this.QR,i=n.rows,s=n.columns,a=new x(i,s);for(r=s-1;r>=0;r--){for(t=0;t<i;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==n.get(r,r)){for(o=0,t=r;t<i;t++)o+=n.get(t,r)*a.get(t,e);for(o=-o/n.get(r,r),t=r;t<i;t++)a.set(t,e,a.get(t,e)+o*n.get(t,r))}}return a}}class P{constructor(t,e={}){if((t=k.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,o=t.columns;const{computeLeftSingularVectors:n=!0,computeRightSingularVectors:i=!0,autoTranspose:s=!1}=e;let a,h=Boolean(n),u=Boolean(i),l=!1;if(r<o)if(s){a=t.transpose(),r=a.rows,o=a.columns,l=!0;let e=h;h=u,u=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(r,o),f=Math.min(r+1,o),m=new Float64Array(f),g=new x(r,c),p=new x(o,o),d=new Float64Array(o),w=new Float64Array(r),y=new Float64Array(f);for(let t=0;t<f;t++)y[t]=t;let v=Math.min(r-1,o),b=Math.max(0,Math.min(o-2,r)),M=Math.max(v,b);for(let t=0;t<M;t++){if(t<v){m[t]=0;for(let e=t;e<r;e++)m[t]=I(m[t],a.get(e,t));if(0!==m[t]){a.get(t,t)<0&&(m[t]=-m[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/m[t]);a.set(t,t,a.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<o;e++){if(t<v&&0!==m[t]){let o=0;for(let n=t;n<r;n++)o+=a.get(n,t)*a.get(n,e);o=-o/a.get(t,t);for(let n=t;n<r;n++)a.set(n,e,a.get(n,e)+o*a.get(n,t))}d[e]=a.get(t,e)}if(h&&t<v)for(let e=t;e<r;e++)g.set(e,t,a.get(e,t));if(t<b){d[t]=0;for(let e=t+1;e<o;e++)d[t]=I(d[t],d[e]);if(0!==d[t]){d[t+1]<0&&(d[t]=0-d[t]);for(let e=t+1;e<o;e++)d[e]/=d[t];d[t+1]+=1}if(d[t]=-d[t],t+1<r&&0!==d[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<o;r++)w[e]+=d[r]*a.get(e,r);for(let e=t+1;e<o;e++){let o=-d[e]/d[t+1];for(let n=t+1;n<r;n++)a.set(n,e,a.get(n,e)+o*w[n])}}if(u)for(let e=t+1;e<o;e++)p.set(e,t,d[e])}}let S=Math.min(o,r+1);if(v<o&&(m[v]=a.get(v,v)),r<S&&(m[S-1]=0),b+1<S&&(d[b]=a.get(b,S-1)),d[S-1]=0,h){for(let t=v;t<c;t++){for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<c;e++){let o=0;for(let n=t;n<r;n++)o+=g.get(n,t)*g.get(n,e);o=-o/g.get(t,t);for(let n=t;n<r;n++)g.set(n,e,g.get(n,e)+o*g.get(n,t))}for(let e=t;e<r;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}}if(u)for(let t=o-1;t>=0;t--){if(t<b&&0!==d[t])for(let e=t+1;e<o;e++){let r=0;for(let n=t+1;n<o;n++)r+=p.get(n,t)*p.get(n,e);r=-r/p.get(t+1,t);for(let n=t+1;n<o;n++)p.set(n,e,p.get(n,e)+r*p.get(n,t))}for(let e=0;e<o;e++)p.set(e,t,0);p.set(t,t,1)}let E=S-1,N=Number.EPSILON;for(;S>0;){let t,e;for(t=S-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+N*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(d[t])<=e||Number.isNaN(d[t])){d[t]=0;break}}if(t===S-2)e=4;else{let r;for(r=S-1;r>=t&&r!==t;r--){let e=(r!==S?Math.abs(d[r]):0)+(r!==t+1?Math.abs(d[r-1]):0);if(Math.abs(m[r])<=N*e){m[r]=0;break}}r===t?e=3:r===S-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=d[S-2];d[S-2]=0;for(let r=S-2;r>=t;r--){let n=I(m[r],e),i=m[r]/n,s=e/n;if(m[r]=n,r!==t&&(e=-s*d[r-1],d[r-1]=i*d[r-1]),u)for(let t=0;t<o;t++)n=i*p.get(t,r)+s*p.get(t,S-1),p.set(t,S-1,-s*p.get(t,r)+i*p.get(t,S-1)),p.set(t,r,n)}break}case 2:{let e=d[t-1];d[t-1]=0;for(let o=t;o<S;o++){let n=I(m[o],e),i=m[o]/n,s=e/n;if(m[o]=n,e=-s*d[o],d[o]=i*d[o],h)for(let e=0;e<r;e++)n=i*g.get(e,o)+s*g.get(e,t-1),g.set(e,t-1,-s*g.get(e,o)+i*g.get(e,t-1)),g.set(e,o,n)}break}case 3:{const e=Math.max(Math.abs(m[S-1]),Math.abs(m[S-2]),Math.abs(d[S-2]),Math.abs(m[t]),Math.abs(d[t])),n=m[S-1]/e,i=m[S-2]/e,s=d[S-2]/e,a=m[t]/e,l=d[t]/e,c=((i+n)*(i-n)+s*s)/2,f=n*s*(n*s);let w=0;0===c&&0===f||(w=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),w=f/(c+w));let y=(a+n)*(a-n)+w,v=a*l;for(let e=t;e<S-1;e++){let n=I(y,v);0===n&&(n=Number.MIN_VALUE);let i=y/n,s=v/n;if(e!==t&&(d[e-1]=n),y=i*m[e]+s*d[e],d[e]=i*d[e]-s*m[e],v=s*m[e+1],m[e+1]=i*m[e+1],u)for(let t=0;t<o;t++)n=i*p.get(t,e)+s*p.get(t,e+1),p.set(t,e+1,-s*p.get(t,e)+i*p.get(t,e+1)),p.set(t,e,n);if(n=I(y,v),0===n&&(n=Number.MIN_VALUE),i=y/n,s=v/n,m[e]=n,y=i*d[e]+s*m[e+1],m[e+1]=-s*d[e]+i*m[e+1],v=s*d[e+1],d[e+1]=i*d[e+1],h&&e<r-1)for(let t=0;t<r;t++)n=i*g.get(t,e)+s*g.get(t,e+1),g.set(t,e+1,-s*g.get(t,e)+i*g.get(t,e+1)),g.set(t,e,n)}d[S-2]=y;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,u))for(let e=0;e<=E;e++)p.set(e,t,-p.get(e,t));for(;t<E&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,u&&t<o-1)for(let r=0;r<o;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);if(h&&t<r-1)for(let o=0;o<r;o++)e=g.get(o,t+1),g.set(o,t+1,g.get(o,t)),g.set(o,t,e);t++}S--}}if(l){let t=p;p=g,g=t}this.m=r,this.n=o,this.s=m,this.U=g,this.V=p}solve(t){let e=t,r=this.threshold,o=this.s.length,n=x.zeros(o,o);for(let t=0;t<o;t++)Math.abs(this.s[t])<=r?n.set(t,t,0):n.set(t,t,1/this.s[t]);let i=this.U,s=this.rightSingularVectors,a=s.mmul(n),h=s.rows,u=i.rows,l=x.zeros(h,u);for(let t=0;t<h;t++)for(let e=0;e<u;e++){let r=0;for(let n=0;n<o;n++)r+=a.get(t,n)*i.get(e,n);l.set(t,e,r)}return l.mmul(e)}solveForDiagonal(t){return this.solve(x.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,o=t.columns,n=new x(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<o;r++)Math.abs(this.s[r])>e&&n.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,s=i.rows,a=i.columns,h=new x(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let o=0;o<a;o++)r+=n.get(t,o)*i.get(e,o);h.set(t,e,r)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let o=0,n=r.length;o<n;o++)r[o]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function _(t,e,r=!1){return t=k.checkMatrix(t),e=k.checkMatrix(e),r?new P(t).solve(e):t.isSquare()?new A(t).solve(e):new O(t).solve(e)}function C(t,e){let r=[];for(let o=0;o<t;o++)o!==e&&r.push(o);return r}function T(t,e,r,o=1e-9,n=1e-9){if(t>n)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<o&&t.set(e,0,0);return t.to1DArray()}}class j{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=k.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let o,n,i=t.columns,s=new x(i,i),a=new Float64Array(i),h=new Float64Array(i),u=t,l=!1;if(l=!!r||t.isSymmetric(),l){for(o=0;o<i;o++)for(n=0;n<i;n++)s.set(o,n,u.get(o,n));!function(t,e,r,o){let n,i,s,a,h,u,l,c;for(h=0;h<t;h++)r[h]=o.get(t-1,h);for(a=t-1;a>0;a--){for(c=0,s=0,u=0;u<a;u++)c+=Math.abs(r[u]);if(0===c)for(e[a]=r[a-1],h=0;h<a;h++)r[h]=o.get(a-1,h),o.set(a,h,0),o.set(h,a,0);else{for(u=0;u<a;u++)r[u]/=c,s+=r[u]*r[u];for(n=r[a-1],i=Math.sqrt(s),n>0&&(i=-i),e[a]=c*i,s-=n*i,r[a-1]=n-i,h=0;h<a;h++)e[h]=0;for(h=0;h<a;h++){for(n=r[h],o.set(h,a,n),i=e[h]+o.get(h,h)*n,u=h+1;u<=a-1;u++)i+=o.get(u,h)*r[u],e[u]+=o.get(u,h)*n;e[h]=i}for(n=0,h=0;h<a;h++)e[h]/=s,n+=e[h]*r[h];for(l=n/(s+s),h=0;h<a;h++)e[h]-=l*r[h];for(h=0;h<a;h++){for(n=r[h],i=e[h],u=h;u<=a-1;u++)o.set(u,h,o.get(u,h)-(n*e[u]+i*r[u]));r[h]=o.get(a-1,h),o.set(a,h,0)}}r[a]=s}for(a=0;a<t-1;a++){if(o.set(t-1,a,o.get(a,a)),o.set(a,a,1),s=r[a+1],0!==s){for(u=0;u<=a;u++)r[u]=o.get(u,a+1)/s;for(h=0;h<=a;h++){for(i=0,u=0;u<=a;u++)i+=o.get(u,a+1)*o.get(u,h);for(u=0;u<=a;u++)o.set(u,h,o.get(u,h)-i*r[u])}}for(u=0;u<=a;u++)o.set(u,a+1,0)}for(h=0;h<t;h++)r[h]=o.get(t-1,h),o.set(t-1,h,0);o.set(t-1,t-1,1),e[0]=0}(i,h,a,s),function(t,e,r,o){let n,i,s,a,h,u,l,c,f,m,g,p,d,w,y,v;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let b=0,M=0,x=Number.EPSILON;for(u=0;u<t;u++){for(M=Math.max(M,Math.abs(r[u])+Math.abs(e[u])),l=u;l<t&&!(Math.abs(e[l])<=x*M);)l++;if(l>u)do{for(n=r[u],c=(r[u+1]-n)/(2*e[u]),f=I(c,1),c<0&&(f=-f),r[u]=e[u]/(c+f),r[u+1]=e[u]*(c+f),m=r[u+1],i=n-r[u],s=u+2;s<t;s++)r[s]-=i;for(b+=i,c=r[l],g=1,p=g,d=g,w=e[u+1],y=0,v=0,s=l-1;s>=u;s--)for(d=p,p=g,v=y,n=g*e[s],i=g*c,f=I(c,e[s]),e[s+1]=y*f,y=e[s]/f,g=c/f,c=g*r[s]-y*n,r[s+1]=i+y*(g*n+y*r[s]),h=0;h<t;h++)i=o.get(h,s+1),o.set(h,s+1,y*o.get(h,s)+g*i),o.set(h,s,g*o.get(h,s)-y*i);c=-y*v*d*w*e[u]/m,e[u]=y*c,r[u]=g*c}while(Math.abs(e[u])>x*M);r[u]=r[u]+b,e[u]=0}for(s=0;s<t-1;s++){for(h=s,c=r[s],a=s+1;a<t;a++)r[a]<c&&(h=a,c=r[a]);if(h!==s)for(r[h]=r[s],r[s]=c,a=0;a<t;a++)c=o.get(a,s),o.set(a,s,o.get(a,h)),o.set(a,h,c)}}(i,h,a,s)}else{let t=new x(i,i),e=new Float64Array(i);for(n=0;n<i;n++)for(o=0;o<i;o++)t.set(o,n,u.get(o,n));!function(t,e,r,o){let n,i,s,a,h,u,l,c=t-1;for(u=1;u<=c-1;u++){for(l=0,a=u;a<=c;a++)l+=Math.abs(e.get(a,u-1));if(0!==l){for(s=0,a=c;a>=u;a--)r[a]=e.get(a,u-1)/l,s+=r[a]*r[a];for(i=Math.sqrt(s),r[u]>0&&(i=-i),s-=r[u]*i,r[u]=r[u]-i,h=u;h<t;h++){for(n=0,a=c;a>=u;a--)n+=r[a]*e.get(a,h);for(n/=s,a=u;a<=c;a++)e.set(a,h,e.get(a,h)-n*r[a])}for(a=0;a<=c;a++){for(n=0,h=c;h>=u;h--)n+=r[h]*e.get(a,h);for(n/=s,h=u;h<=c;h++)e.set(a,h,e.get(a,h)-n*r[h])}r[u]=l*r[u],e.set(u,u-1,l*i)}}for(a=0;a<t;a++)for(h=0;h<t;h++)o.set(a,h,a===h?1:0);for(u=c-1;u>=1;u--)if(0!==e.get(u,u-1)){for(a=u+1;a<=c;a++)r[a]=e.get(a,u-1);for(h=u;h<=c;h++){for(i=0,a=u;a<=c;a++)i+=r[a]*o.get(a,h);for(i=i/r[u]/e.get(u,u-1),a=u;a<=c;a++)o.set(a,h,o.get(a,h)+i*r[a])}}}(i,t,e,s),function(t,e,r,o,n){let i,s,a,h,u,l,c,f,m,g,p,d,w,y,v,b=t-1,M=t-1,x=Number.EPSILON,S=0,E=0,N=0,R=0,z=0,k=0,A=0,I=0;for(i=0;i<t;i++)for((i<0||i>M)&&(r[i]=n.get(i,i),e[i]=0),s=Math.max(i-1,0);s<t;s++)E+=Math.abs(n.get(i,s));for(;b>=0;){for(h=b;h>0&&(k=Math.abs(n.get(h-1,h-1))+Math.abs(n.get(h,h)),0===k&&(k=E),!(Math.abs(n.get(h,h-1))<x*k));)h--;if(h===b)n.set(b,b,n.get(b,b)+S),r[b]=n.get(b,b),e[b]=0,b--,I=0;else if(h===b-1){if(c=n.get(b,b-1)*n.get(b-1,b),N=(n.get(b-1,b-1)-n.get(b,b))/2,R=N*N+c,A=Math.sqrt(Math.abs(R)),n.set(b,b,n.get(b,b)+S),n.set(b-1,b-1,n.get(b-1,b-1)+S),f=n.get(b,b),R>=0){for(A=N>=0?N+A:N-A,r[b-1]=f+A,r[b]=r[b-1],0!==A&&(r[b]=f-c/A),e[b-1]=0,e[b]=0,f=n.get(b,b-1),k=Math.abs(f)+Math.abs(A),N=f/k,R=A/k,z=Math.sqrt(N*N+R*R),N/=z,R/=z,s=b-1;s<t;s++)A=n.get(b-1,s),n.set(b-1,s,R*A+N*n.get(b,s)),n.set(b,s,R*n.get(b,s)-N*A);for(i=0;i<=b;i++)A=n.get(i,b-1),n.set(i,b-1,R*A+N*n.get(i,b)),n.set(i,b,R*n.get(i,b)-N*A);for(i=0;i<=M;i++)A=o.get(i,b-1),o.set(i,b-1,R*A+N*o.get(i,b)),o.set(i,b,R*o.get(i,b)-N*A)}else r[b-1]=f+N,r[b]=f+N,e[b-1]=A,e[b]=-A;b-=2,I=0}else{if(f=n.get(b,b),m=0,c=0,h<b&&(m=n.get(b-1,b-1),c=n.get(b,b-1)*n.get(b-1,b)),10===I){for(S+=f,i=0;i<=b;i++)n.set(i,i,n.get(i,i)-f);k=Math.abs(n.get(b,b-1))+Math.abs(n.get(b-1,b-2)),f=m=.75*k,c=-.4375*k*k}if(30===I&&(k=(m-f)/2,k=k*k+c,k>0)){for(k=Math.sqrt(k),m<f&&(k=-k),k=f-c/((m-f)/2+k),i=0;i<=b;i++)n.set(i,i,n.get(i,i)-k);S+=k,f=m=c=.964}for(I+=1,u=b-2;u>=h&&(A=n.get(u,u),z=f-A,k=m-A,N=(z*k-c)/n.get(u+1,u)+n.get(u,u+1),R=n.get(u+1,u+1)-A-z-k,z=n.get(u+2,u+1),k=Math.abs(N)+Math.abs(R)+Math.abs(z),N/=k,R/=k,z/=k,u!==h)&&!(Math.abs(n.get(u,u-1))*(Math.abs(R)+Math.abs(z))<x*(Math.abs(N)*(Math.abs(n.get(u-1,u-1))+Math.abs(A)+Math.abs(n.get(u+1,u+1)))));)u--;for(i=u+2;i<=b;i++)n.set(i,i-2,0),i>u+2&&n.set(i,i-3,0);for(a=u;a<=b-1&&(y=a!==b-1,a!==u&&(N=n.get(a,a-1),R=n.get(a+1,a-1),z=y?n.get(a+2,a-1):0,f=Math.abs(N)+Math.abs(R)+Math.abs(z),0!==f&&(N/=f,R/=f,z/=f)),0!==f);a++)if(k=Math.sqrt(N*N+R*R+z*z),N<0&&(k=-k),0!==k){for(a!==u?n.set(a,a-1,-k*f):h!==u&&n.set(a,a-1,-n.get(a,a-1)),N+=k,f=N/k,m=R/k,A=z/k,R/=N,z/=N,s=a;s<t;s++)N=n.get(a,s)+R*n.get(a+1,s),y&&(N+=z*n.get(a+2,s),n.set(a+2,s,n.get(a+2,s)-N*A)),n.set(a,s,n.get(a,s)-N*f),n.set(a+1,s,n.get(a+1,s)-N*m);for(i=0;i<=Math.min(b,a+3);i++)N=f*n.get(i,a)+m*n.get(i,a+1),y&&(N+=A*n.get(i,a+2),n.set(i,a+2,n.get(i,a+2)-N*z)),n.set(i,a,n.get(i,a)-N),n.set(i,a+1,n.get(i,a+1)-N*R);for(i=0;i<=M;i++)N=f*o.get(i,a)+m*o.get(i,a+1),y&&(N+=A*o.get(i,a+2),o.set(i,a+2,o.get(i,a+2)-N*z)),o.set(i,a,o.get(i,a)-N),o.set(i,a+1,o.get(i,a+1)-N*R)}}}if(0!==E){for(b=t-1;b>=0;b--)if(N=r[b],R=e[b],0===R)for(h=b,n.set(b,b,1),i=b-1;i>=0;i--){for(c=n.get(i,i)-N,z=0,s=h;s<=b;s++)z+=n.get(i,s)*n.get(s,b);if(e[i]<0)A=c,k=z;else if(h=i,0===e[i]?n.set(i,b,0!==c?-z/c:-z/(x*E)):(f=n.get(i,i+1),m=n.get(i+1,i),R=(r[i]-N)*(r[i]-N)+e[i]*e[i],l=(f*k-A*z)/R,n.set(i,b,l),n.set(i+1,b,Math.abs(f)>Math.abs(A)?(-z-c*l)/f:(-k-m*l)/A)),l=Math.abs(n.get(i,b)),x*l*l>1)for(s=i;s<=b;s++)n.set(s,b,n.get(s,b)/l)}else if(R<0)for(h=b-1,Math.abs(n.get(b,b-1))>Math.abs(n.get(b-1,b))?(n.set(b-1,b-1,R/n.get(b,b-1)),n.set(b-1,b,-(n.get(b,b)-N)/n.get(b,b-1))):(v=F(0,-n.get(b-1,b),n.get(b-1,b-1)-N,R),n.set(b-1,b-1,v[0]),n.set(b-1,b,v[1])),n.set(b,b-1,0),n.set(b,b,1),i=b-2;i>=0;i--){for(g=0,p=0,s=h;s<=b;s++)g+=n.get(i,s)*n.get(s,b-1),p+=n.get(i,s)*n.get(s,b);if(c=n.get(i,i)-N,e[i]<0)A=c,z=g,k=p;else if(h=i,0===e[i]?(v=F(-g,-p,c,R),n.set(i,b-1,v[0]),n.set(i,b,v[1])):(f=n.get(i,i+1),m=n.get(i+1,i),d=(r[i]-N)*(r[i]-N)+e[i]*e[i]-R*R,w=2*(r[i]-N)*R,0===d&&0===w&&(d=x*E*(Math.abs(c)+Math.abs(R)+Math.abs(f)+Math.abs(m)+Math.abs(A))),v=F(f*z-A*g+R*p,f*k-A*p-R*g,d,w),n.set(i,b-1,v[0]),n.set(i,b,v[1]),Math.abs(f)>Math.abs(A)+Math.abs(R)?(n.set(i+1,b-1,(-g-c*n.get(i,b-1)+R*n.get(i,b))/f),n.set(i+1,b,(-p-c*n.get(i,b)-R*n.get(i,b-1))/f)):(v=F(-z-m*n.get(i,b-1),-k-m*n.get(i,b),A,R),n.set(i+1,b-1,v[0]),n.set(i+1,b,v[1]))),l=Math.max(Math.abs(n.get(i,b-1)),Math.abs(n.get(i,b))),x*l*l>1)for(s=i;s<=b;s++)n.set(s,b-1,n.get(s,b-1)/l),n.set(s,b,n.get(s,b)/l)}for(i=0;i<t;i++)if(i<0||i>M)for(s=i;s<t;s++)o.set(i,s,n.get(i,s));for(s=t-1;s>=0;s--)for(i=0;i<=M;i++){for(A=0,a=0;a<=Math.min(s,M);a++)A+=o.get(i,a)*n.get(a,s);o.set(i,s,A)}}}(i,h,a,s,t)}this.n=i,this.e=h,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,o=this.e,n=this.d,i=new x(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)i.set(t,e,0);i.set(t,t,n[t]),o[t]>0?i.set(t,t+1,o[t]):o[t]<0&&i.set(t,t-1,o[t])}return i}}function F(t,e,r,o){let n,i;return Math.abs(r)>Math.abs(o)?(n=o/r,i=r+n*o,[(t+n*e)/i,(e-n*t)/i]):(n=r/o,i=o+n*r,[(n*t+e)/i,(n*e-t)/i])}class D{constructor(t){if(!(t=k.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,o,n=t,i=n.rows,s=new x(i,i),a=!0;for(r=0;r<i;r++){let t=0;for(o=0;o<r;o++){let i=0;for(e=0;e<o;e++)i+=s.get(o,e)*s.get(r,e);i=(n.get(r,o)-i)/s.get(o,o),s.set(r,o,i),t+=i*i}for(t=n.get(r,r)-t,a&=t>0,s.set(r,r,Math.sqrt(Math.max(t,0))),o=r+1;o<i;o++)s.set(r,o,0)}this.L=s,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=k.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let o,n,i,s=t.columns,a=t.clone();for(i=0;i<r;i++)for(n=0;n<s;n++){for(o=0;o<i;o++)a.set(i,n,a.get(i,n)-a.get(o,n)*e.get(i,o));a.set(i,n,a.get(i,n)/e.get(i,i))}for(i=r-1;i>=0;i--)for(n=0;n<s;n++){for(o=i+1;o<r;o++)a.set(i,n,a.get(i,n)-a.get(o,n)*e.get(o,i));a.set(i,n,a.get(i,n)/e.get(i,i))}return a}get lowerTriangularMatrix(){return this.L}}class V{constructor(t,e={}){t=k.checkMatrix(t);let{Y:r}=e;const{scaleScores:n=!1,maxIterations:i=1e3,terminationCriteria:s=1e-10}=e;let a;if(r){if(r=o.isAnyArray(r)&&"number"==typeof r[0]?x.columnVector(r):k.checkMatrix(r),r.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=r.getColumnVector(0)}else a=t.getColumnVector(0);let h,u,l,c,f=1;for(let e=0;e<i&&f>s;e++)l=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),l=l.div(l.norm()),h=t.mmul(l).div(l.transpose().mmul(l).get(0,0)),e>0&&(f=h.clone().sub(c).pow(2).sum()),c=h.clone(),r?(u=r.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),u=u.div(u.norm()),a=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):a=h;if(r){let e=t.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));e=e.div(e.norm());let o=t.clone().sub(h.clone().mmul(e.transpose())),n=a.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),i=r.clone().sub(h.clone().mulS(n.get(0,0)).mmul(u.transpose()));this.t=h,this.p=e.transpose(),this.w=l.transpose(),this.q=u,this.u=a,this.s=h.transpose().mmul(h),this.xResidual=o,this.yResidual=i,this.betas=n}else this.w=l.transpose(),this.s=h.transpose().mmul(h).sqrt(),this.t=n?h.clone().div(this.s.get(0,0)):h,this.xResidual=t.sub(h.mmul(l.transpose()))}}e.y3=b,e.jy=D,e.oN=D,e.Hc=E,e.cg=j,e.hj=j,e.LU=A,e.Tb=A,e.uq=x,e.Zm=class extends N{constructor(t,e){p(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.Dq=class extends N{constructor(t,e){c(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},e.__=class extends N{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.q0=class extends N{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.lh=class extends N{constructor(t,e){g(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.pI=class extends N{constructor(t,e){l(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},e.zC=R,e.zg=class extends N{constructor(t,e,r,o,n){d(t,e,r,o,n),super(t,r-e+1,n-o+1),this.startRow=e,this.startColumn=o}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.g6=class extends N{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},e.OL=V,e.ks=V,e.QR=O,e.jp=O,e.mk=P,e.W2=P,e.l=S,e.KY=z,e.dv=k,e.BR=function(t,e=t,r={}){t=new x(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||o.isAnyArray(e)?e=new x(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:s=!0}=r;i&&(t.center("column"),n||e.center("column")),s&&(t.scale("column"),n||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),h=n?a:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let e=0;e<u.rows;e++)for(let r=0;r<u.columns;r++)u.set(e,r,u.get(e,r)*(1/(a[e]*h[r]))*(1/(t.rows-1)));return u},e.Wu=function(t,e=t,r={}){t=new x(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||o.isAnyArray(e)?e=new x(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=r;i&&(t=t.center("column"),n||(e=e.center("column")));const s=t.transpose().mmul(e);for(let e=0;e<s.rows;e++)for(let r=0;r<s.columns;r++)s.set(e,r,s.get(e,r)*(1/(t.rows-1)));return s},e.a4=function t(e){if((e=x.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let r,o,n,i;if(2===e.columns)return r=e.get(0,0),o=e.get(0,1),n=e.get(1,0),i=e.get(1,1),r*i-o*n;if(3===e.columns){let i,s,a;return i=new R(e,[1,2],[1,2]),s=new R(e,[1,2],[0,2]),a=new R(e,[1,2],[0,1]),r=e.get(0,0),o=e.get(0,1),n=e.get(0,2),r*t(i)-o*t(s)+n*t(a)}return new A(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.DI=function(t,e=!1){return t=k.checkMatrix(t),e?new P(t).inverse():_(t,x.eye(t.rows))},e.Jo=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:o=1e-9}=e;let n=(t=x.checkMatrix(t)).rows,i=new x(n,n);for(let e=0;e<n;e++){let s=x.columnVector(t.getRow(e)),a=t.subMatrixRow(C(n,e)).transpose(),h=new P(a).solve(s),u=x.sub(s,a.mmul(h)).abs().max();i.setRow(e,T(u,h,e,r,o))}return i},e.Zi=function(t,e=Number.EPSILON){if((t=x.checkMatrix(t)).isEmpty())return t.transpose();let r=new P(t,{autoTranspose:!0}),o=r.leftSingularVectors,n=r.rightSingularVectors,i=r.diagonal;for(let t=0;t<i.length;t++)Math.abs(i[t])>e?i[t]=1/i[t]:i[t]=0;return n.mmul(x.diag(i).mmul(o.transpose()))},e.kH=_,e.LV=function(t,e){if(o.isAnyArray(t))return t[0]&&o.isAnyArray(t[0])?new k(t):new z(t,e);throw new Error("the argument is not an array")}},103:(t,e,r)=>{r.r(e),r.d(e,{isAnyArray:()=>n});const o=Object.prototype.toString;function n(t){const e=o.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},24:function(t,e,r){var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&o(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.smallestFlagged=e.deheapSort=e.buildCandidates=e.uncheckedHeapPush=e.heapPush=e.rejectionSample=e.makeHeap=void 0;var s=i(r(185));function a(t,e){var r=function(r){return s.empty(t).map((function(){return s.filled(e,r)}))},o=[];return o.push(r(-1)),o.push(r(1/0)),o.push(r(0)),o}function h(t,e,r,o,n){e=Math.floor(e);var i=t[0][e],s=t[1][e];if(t[2][e],r>=s[0])return 0;for(var a=0;a<i.length;a++)if(o===i[a])return 0;return u(t,e,r,o,n)}function u(t,e,r,o,n){var i=t[0][e],s=t[1][e],a=t[2][e];if(r>=s[0])return 0;s[0]=r,i[0]=o,a[0]=n;for(var h=0,u=0;;){var l=2*h+1,c=l+1,f=t[0][0].length;if(l>=f)break;if(c>=f){if(!(s[l]>r))break;u=l}else if(s[l]>=s[c]){if(!(r<s[l]))break;u=l}else{if(!(r<s[c]))break;u=c}s[h]=s[u],i[h]=i[u],a[h]=a[u],h=u}return s[h]=r,i[h]=o,a[h]=n,1}function l(t,e,r,o){for(;2*o+1<r;){var n=2*o+1,i=n+1,s=o;if(t[s]<t[n]&&(s=n),i<r&&t[s]<t[i]&&(s=i),s===o)break;var a=t[o];t[o]=t[s],t[s]=a;var h=e[o];e[o]=e[s],e[s]=h,o=s}}e.makeHeap=a,e.rejectionSample=function(t,e,r){for(var o=s.zeros(t),n=0;n<t;n++){for(var i=!0,a=0;i;){a=s.tauRandInt(e,r);for(var h=!1,u=0;u<n;u++)if(a===o[u]){h=!0;break}h||(i=!1)}o[n]=a}return o},e.heapPush=h,e.uncheckedHeapPush=u,e.buildCandidates=function(t,e,r,o,n){for(var i=a(e,o),u=0;u<e;u++)for(var l=0;l<r;l++)if(!(t[0][u][l]<0)){var c=t[0][u][l],f=t[2][u][l],m=s.tauRand(n);h(i,u,m,c,f),h(i,c,m,u,f),t[2][u][l]=0}return i},e.deheapSort=function(t){for(var e=t[0],r=t[1],o=0;o<e.length;o++)for(var n=e[o],i=r[o],s=0;s<n.length-1;s++){var a=n.length-s-1,h=i.length-s-1,u=n[0];n[0]=n[a],n[a]=u;var c=i[0];i[0]=i[h],i[h]=c,l(i,n,h,0)}return{indices:e,weights:r}},e.smallestFlagged=function(t,e){for(var r=t[0][e],o=t[1][e],n=t[2][e],i=1/0,s=-1,a=0;a>r.length;a++)1===n[a]&&o[a]<i&&(i=o[a],s=a);return s>=0?(n[s]=0,Math.floor(r[s])):-1}},499:function(t,e,r){var o,n=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s},h=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getCSR=e.normalize=e.eliminateZeros=e.multiplyScalar=e.maximum=e.subtract=e.add=e.pairwiseMultiply=e.identity=e.transpose=e.SparseMatrix=void 0;var u=s(r(185)),l=function(){function t(t,e,r,o){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=o[0],this.nCols=o[1];for(var n=0;n<r.length;n++){var i=t[n],s=e[n];this.checkDims(i,s);var a=this.makeKey(i,s);this.entries.set(a,{value:r[n],row:i,col:s})}}return t.prototype.makeKey=function(t,e){return"".concat(t,":").concat(e)},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var o=this.makeKey(t,e);this.entries.has(o)?this.entries.get(o).value=r:this.entries.set(o,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var o=this.makeKey(t,e);return this.entries.has(o)?this.entries.get(o).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach((function(t){e.push(t)})),t&&e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row})),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,(function(t){var e=a(t,2);return e[0],e[1].row}))},t.prototype.getCols=function(){return Array.from(this.entries,(function(t){var e=a(t,2);return e[0],e[1].col}))},t.prototype.getValues=function(){return Array.from(this.entries,(function(t){var e=a(t,2);return e[0],e[1].value}))},t.prototype.forEach=function(t){this.entries.forEach((function(e){return t(e.value,e.row,e.col)}))},t.prototype.map=function(e){var r=[];this.entries.forEach((function(t){r.push(e(t.value,t.row,t.col))}));var o=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,o)},t.prototype.toArray=function(){var t=this,e=u.empty(this.nRows).map((function(){return u.zeros(t.nCols)}));return this.entries.forEach((function(t){e[t.row][t.col]=t.value})),e},t.prototype.setEntries=function(t){this.entries=new Map(t)},t.prototype.serialize=function(){return{nRows:this.nRows,nCols:this.nCols,entries:Array.from(this.entries.entries())}},t.deserialize=function(e){var r=new t([],[],[],[e.nRows,e.nCols]);return r.setEntries(e.entries),r},t}();e.SparseMatrix=l,e.transpose=function(t){var e=[],r=[],o=[];t.forEach((function(t,n,i){e.push(n),r.push(i),o.push(t)}));var n=[t.nCols,t.nRows];return new l(r,e,o,n)},e.identity=function(t){for(var e=a(t,1)[0],r=new l([],[],[],t),o=0;o<e;o++)r.set(o,o,1);return r},e.pairwiseMultiply=function(t,e){return f(t,e,(function(t,e){return t*e}))},e.add=function(t,e){return f(t,e,(function(t,e){return t+e}))},e.subtract=function(t,e){return f(t,e,(function(t,e){return t-e}))},e.maximum=function(t,e){return f(t,e,(function(t,e){return t>e?t:e}))},e.multiplyScalar=function(t,e){return t.map((function(t){return t*e}))},e.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),o=t.getRows(),n=t.getCols(),i=0;i<r.length;i++)0===r[i]&&e.add(i);var s=function(t,r){return!e.has(r)},a=r.filter(s),h=o.filter(s),u=n.filter(s);return new l(h,u,a,t.getDims())},e.normalize=function(t,e){var r,o;void 0===e&&(e="l2");var n=c[e],i=new Map;t.forEach((function(t,e,r){var o=i.get(e)||[];o.push(r),i.set(e,o)}));var s=new l([],[],[],t.getDims()),a=function(e){for(var r=i.get(e).sort(),o=r.map((function(r){return t.get(e,r)})),a=n(o),h=0;h<a.length;h++)s.set(e,r[h],a[h])};try{for(var u=h(i.keys()),f=u.next();!f.done;f=u.next())a(f.value)}catch(t){r={error:t}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return s};var c=((o={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map((function(t){return t/e}))},o.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map((function(t){return t/e}))},o.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map((function(t){return Math.sqrt(Math.pow(t,2)/e)}))},o);function f(t,e,r){for(var o=new Set,n=[],i=[],s=[],a=function(o,a){n.push(o),i.push(a);var h=r(t.get(o,a),e.get(o,a));s.push(h)},h=t.getValues(),u=t.getRows(),c=t.getCols(),f=0;f<h.length;f++){var m=u[f],g=c[f],p="".concat(m,":").concat(g);o.add(p),a(m,g)}var d=e.getValues(),w=e.getRows(),y=e.getCols();for(f=0;f<d.length;f++)m=w[f],g=y[f],p="".concat(m,":").concat(g),o.has(p)||a(m,g);var v=[t.nRows,t.nCols];return new l(n,i,s,v)}e.getCSR=function(t){var e=[];t.forEach((function(t,r,o){e.push({value:t,row:r,col:o})})),e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}));for(var r=[],o=[],n=[],i=-1,s=0;s<e.length;s++){var a=e[s],h=a.row,u=a.col,l=a.value;h!==i&&(i=h,n.push(s)),r.push(u),o.push(l)}return{indices:r,values:o,indptr:n}}},47:function(t,e,r){var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&o(e,t,r);return n(e,t),e},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.initializeSearch=e.makeInitializedNNSearch=e.makeInitializations=e.makeNNDescent=void 0;var a=i(r(24)),h=i(r(499)),u=i(r(450)),l=i(r(185));e.makeNNDescent=function(t,e){return function(r,o,n,i,s,h,u,c){void 0===i&&(i=10),void 0===s&&(s=50),void 0===h&&(h=.001),void 0===u&&(u=.5),void 0===c&&(c=!0);for(var f=r.length,m=a.makeHeap(r.length,n),g=0;g<r.length;g++)for(var p=a.rejectionSample(n,r.length,e),d=0;d<p.length;d++){var w=t(r[g],r[p[d]]);a.heapPush(m,g,w,p[d],1),a.heapPush(m,p[d],w,g,1)}if(c)for(var y=0;y<o.length;y++)for(g=0;g<o[y].length&&!(o[y][g]<0);g++)for(d=g+1;d<o[y].length&&!(o[y][d]<0);d++)w=t(r[o[y][g]],r[o[y][d]]),a.heapPush(m,o[y][g],w,o[y][d],1),a.heapPush(m,o[y][d],w,o[y][g],1);for(y=0;y<i;y++){var v=a.buildCandidates(m,f,n,s,e),b=0;for(g=0;g<f;g++)for(d=0;d<s;d++){var M=Math.floor(v[0][g][d]);if(!(M<0||l.tauRand(e)<u))for(var x=0;x<s;x++){var S=Math.floor(v[0][g][x]),E=v[2][g][d],N=v[2][g][x];S<0||!E&&!N||(w=t(r[M],r[S]),b+=a.heapPush(m,M,w,S,1),b+=a.heapPush(m,S,w,M,1))}}if(b<=h*n*r.length)break}return a.deheapSort(m)}},e.makeInitializations=function(t){return{initFromRandom:function(e,r,o,n,i){for(var s=0;s<o.length;s++)for(var h=l.rejectionSample(e,r.length,i),u=0;u<h.length;u++)if(!(h[u]<0)){var c=t(r[h[u]],o[s]);a.heapPush(n,s,c,h[u],1)}},initFromTree:function(e,r,o,n,i){for(var s=0;s<o.length;s++)for(var h=u.searchFlatTree(o[s],e,i),l=0;l<h.length;l++){if(h[l]<0)return;var c=t(r[h[l]],o[s]);a.heapPush(n,s,c,h[l],1)}}}},e.makeInitializedNNSearch=function(t){return function(e,r,o,n){for(var i,u,l=h.getCSR(r),c=l.indices,f=l.indptr,m=0;m<n.length;m++)for(var g=new Set(o[0][m]);;){var p=a.smallestFlagged(o,m);if(-1===p)break;var d=c.slice(f[p],f[p+1]);try{for(var w=(i=void 0,s(d)),y=w.next();!y.done;y=w.next()){var v=y.value;if(v!==p&&-1!==v&&!g.has(v)){var b=t(e[v],n[m]);a.uncheckedHeapPush(o,m,b,v,1),g.add(v)}}}catch(t){i={error:t}}finally{try{y&&!y.done&&(u=w.return)&&u.call(w)}finally{if(i)throw i.error}}}return o}},e.initializeSearch=function(t,e,r,o,n,i,h){var u,l,c=a.makeHeap(r.length,o);if(n(o,e,r,c,h),t)try{for(var f=s(t),m=f.next();!m.done;m=f.next())i(m.value,e,r,c,h)}catch(t){u={error:t}}finally{try{m&&!m.done&&(l=f.return)&&l.call(f)}finally{if(u)throw u.error}}return c}},450:function(t,e,r){var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&o(e,t,r);return n(e,t),e},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var o,n=0,i=e.length;n<i;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},h=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.searchFlatTree=e.makeLeafArray=e.makeForest=e.FlatTree=void 0;var u=i(r(185)),l=function(){function t(t,e,r,o){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=o}return t.prototype.serialize=function(){return{hyperplanes:this.hyperplanes,offsets:this.offsets,children:this.children,indices:this.indices}},t.deserialize=function(e){return new t(e.hyperplanes,e.offsets,e.children,e.indices)},t}();function c(t,e,r,o,n){if(void 0===r&&(r=30),e.length>r){var i=function(t,e,r){var o=t[0].length,n=u.tauRandInt(e.length,r),i=u.tauRandInt(e.length,r);i=(i+=n===i?1:0)%e.length;for(var s=e[n],a=e[i],h=0,l=u.zeros(o),c=0;c<l.length;c++)l[c]=t[s][c]-t[a][c],h-=l[c]*(t[s][c]+t[a][c])/2;var f=0,m=0,g=u.zeros(e.length);for(c=0;c<e.length;c++){for(var p=h,d=0;d<o;d++)p+=l[d]*t[e[c]][d];0===p?(g[c]=u.tauRandInt(2,r),0===g[c]?f+=1:m+=1):p>0?(g[c]=0,f+=1):(g[c]=1,m+=1)}var w=u.zeros(f),y=u.zeros(m);for(f=0,m=0,c=0;c<g.length;c++)0===g[c]?(w[f]=e[c],f+=1):(y[m]=e[c],m+=1);return{indicesLeft:w,indicesRight:y,hyperplane:l,offset:h}}(t,e,n),s=i.indicesLeft,a=i.indicesRight,h=i.hyperplane,l=i.offset;return{leftChild:c(t,s,r,o+1,n),rightChild:c(t,a,r,o+1,n),isLeaf:!1,hyperplane:h,offset:l}}return{indices:e,isLeaf:!0}}function f(t,e,r,o,n,i,h){var u;if(t.isLeaf)return o[i][0]=-h,(u=n[h]).splice.apply(u,a([0,t.indices.length],s(t.indices),!1)),{nodeNum:i,leafNum:h+=1};e[i]=t.hyperplane,r[i]=t.offset,o[i][0]=i+1;var l=i,c=f(t.leftChild,e,r,o,n,i+1,h);return i=c.nodeNum,h=c.leafNum,o[l][1]=i+1,{nodeNum:(c=f(t.rightChild,e,r,o,n,i+1,h)).nodeNum,leafNum:c.leafNum}}function m(t){return t.isLeaf?1:1+m(t.leftChild)+m(t.rightChild)}function g(t){return t.isLeaf?1:g(t.leftChild)+g(t.rightChild)}function p(t,e,r,o){for(var n=e,i=0;i<r.length;i++)n+=t[i]*r[i];return 0===n?u.tauRandInt(2,o):n>0?0:1}e.FlatTree=l,e.makeForest=function(t,e,r,o){var n=Math.max(10,e);return u.range(r).map((function(e,r){return function(t,e,r,o){return void 0===e&&(e=30),c(t,u.range(t.length),e,r,o)}(t,n,r,o)})).map((function(t){return function(t,e){var r=m(t),o=g(t),n=u.range(r).map((function(){return u.zeros(t.hyperplane?t.hyperplane.length:0)})),i=u.zeros(r),s=u.range(r).map((function(){return[-1,-1]})),a=u.range(o).map((function(){return u.range(e).map((function(){return-1}))}));return f(t,n,i,s,a,0,0),new l(n,i,s,a)}(t,n)}))},e.makeLeafArray=function(t){var e,r;if(t.length>0){var o=[];try{for(var n=h(t),i=n.next();!i.done;i=n.next()){var u=i.value;o.push.apply(o,a([],s(u.indices),!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return o}return[[-1]]},e.searchFlatTree=function(t,e,r){for(var o=0;e.children[o][0]>0;)o=0===p(e.hyperplanes[o],e.offsets[o],t,r)?e.children[o][0]:e.children[o][1];var n=-1*e.children[o][0];return e.indices[n]}},329:function(t,e,r){var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&o(e,t,r);return n(e,t),e},s=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))((function(n,i){function s(t){try{h(o.next(t))}catch(t){i(t)}}function a(t){try{h(o.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}h((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var r,o,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(h){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,h])}}},h=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s},u=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var o,n=0,i=e.length;n<i;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.initTransform=e.resetLocalConnectivity=e.fastIntersection=e.findABParams=e.cosine=e.euclidean=e.UMAP=void 0;var c=i(r(24)),f=i(r(499)),m=i(r(47)),g=i(r(450)),p=i(r(185)),d=l(r(142)),w=1e-5,y=.001,v=function(){function t(t){void 0===t&&(t={});var e=this;this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=b,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new M;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t){return s(this,arguments,void 0,(function(t,e){return void 0===e&&(e=function(){return!0}),a(this,(function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}}))}))},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points (".concat(t.length,") to create nNeighbors: ").concat(this.nNeighbors,".  Add more data points or adjust the configuration."));if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),o=r.head,n=r.tail,i=r.epochsPerSample;return this.optimizationState.head=o,this.optimizationState.tail=n,this.optimizationState.epochsPerSample=i,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=m.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=m.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,o=[t.length,t.length],n=new f.SparseMatrix([],[],[],o),i=0;i<e.length;i++)for(var s=e[i],a=r[i],h=0;h<s.length;h++){var u=s[h],l=a[h];l>0&&n.set(i,u,l)}var c=f.transpose(n);return f.maximum(n,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var o=Math.floor(this.nNeighbors*this.transformQueueSize);o=Math.min(r.length,o);var n=m.initializeSearch(this.rpForest,r,t,o,this.initFromRandom,this.initFromTree,this.random),i=this.search(r,this.searchGraph,n,t),s=c.deheapSort(i),a=s.indices,h=s.weights;a=a.map((function(t){return t.slice(0,e.nNeighbors)})),h=h.map((function(t){return t.slice(0,e.nNeighbors)}));var u=Math.max(0,this.localConnectivity-1),l=this.smoothKNNDistance(h,this.nNeighbors,u),g=l.sigmas,d=l.rhos,w=this.computeMembershipStrengths(a,h,g,d),y=w.rows,v=w.cols,b=w.vals,M=[t.length,r.length],x=new f.SparseMatrix(y,v,b,M),S=f.normalize(x,"l1"),E=f.getCSR(S),N=t.length,R=z(p.reshape2d(E.indices,N,this.nNeighbors),p.reshape2d(E.values,N,this.nNeighbors),this.embedding),k=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,A=x.getValues().reduce((function(t,e){return e>t?e:t}),0);x=x.map((function(t){return t<A/k?0:t})),x=f.eliminateZeros(x);var I=this.makeEpochsPerSample(x.getValues(),k),O=x.getRows(),P=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:R,tailEmbedding:this.embedding,head:O,tail:P,currentEpoch:0,nEpochs:k,nVertices:x.getDims()[1],epochsPerSample:I}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,o=this.nNeighbors,n=m.makeNNDescent(r,this.random),i=5+Math.floor(.5==(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),s=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=g.makeForest(t,o,i,this.random);var a=n(t,g.makeLeafArray(this.rpForest),o,s);return{knnIndices:a.indices,knnDistances:a.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var o=this,n=o.knnIndices,i=void 0===n?[]:n,s=o.knnDistances,a=void 0===s?[]:s,h=o.localConnectivity,u=this.smoothKNNDistance(a,e,h),l=u.sigmas,c=u.rhos,m=this.computeMembershipStrengths(i,a,l,c),g=m.rows,p=m.cols,d=m.vals,w=[t.length,t.length],y=new f.SparseMatrix(g,p,d,w),v=f.transpose(y),b=f.pairwiseMultiply(y,v),M=f.subtract(f.add(y,v),b),x=f.multiplyScalar(M,r),S=f.multiplyScalar(b,1-r);return f.add(x,S)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,o){void 0===o&&(o=1);var n=N(t,e,o,r);return R(n=f.eliminateZeros(n))},t.prototype.smoothKNNDistance=function(t,e,r,o,n){void 0===r&&(r=1),void 0===o&&(o=64),void 0===n&&(n=1);for(var i=Math.log(e)/Math.log(2)*n,s=p.zeros(t.length),a=p.zeros(t.length),h=0;h<t.length;h++){var u=0,l=1/0,c=1,f=t[h],m=f.filter((function(t){return t>0}));if(m.length>=r){var g=Math.floor(r),d=r-g;g>0?(s[h]=m[g-1],d>w&&(s[h]+=d*(m[g]-m[g-1]))):s[h]=d*m[0]}else m.length>0&&(s[h]=p.max(m));for(var v=0;v<o;v++){for(var b=0,M=1;M<t[h].length;M++){var x=t[h][M]-s[h];b+=x>0?Math.exp(-x/c):1}if(Math.abs(b-i)<w)break;b>i?c=(u+(l=c))/2:(u=c,l===1/0?c*=2:c=(u+l)/2)}if(a[h]=c,s[h]>0){var S=p.mean(f);a[h]<y*S&&(a[h]=y*S)}else{var E=p.mean(t.map(p.mean));a[h]<y*E&&(a[h]=y*E)}}return{sigmas:a,rhos:s}},t.prototype.computeMembershipStrengths=function(t,e,r,o){for(var n=t.length,i=t[0].length,s=p.zeros(n*i),a=p.zeros(n*i),h=p.zeros(n*i),u=0;u<n;u++)for(var l=0;l<i;l++){var c=0;-1!==t[u][l]&&(c=t[u][l]===u?0:e[u][l]-o[u]<=0?1:Math.exp(-(e[u][l]-o[u])/r[u]),s[u*i+l]=u,a[u*i+l]=t[u][l],h[u*i+l]=c)}return{rows:s,cols:a,vals:h}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,o=this.graph.getValues(),n=0,i=0;i<o.length;i++){var s=o[i];n<o[i]&&(n=s)}var a=this.graph.map((function(t){return t<n/e?0:t}));this.embedding=p.zeros(a.nRows).map((function(){return p.zeros(r).map((function(){return 20*p.tauRand(t.random)-10}))}));var h=[],u=[],l=[],c=a.getAll();for(i=0;i<c.length;i++){var f=c[i];f.value&&(h.push(f.value),l.push(f.row),u.push(f.col))}return{head:u,tail:l,epochsPerSample:this.makeEpochsPerSample(h,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=p.filled(t.length,-1),o=p.max(t),n=t.map((function(t){return t/o*e}));return n.forEach((function(t,o){t>0&&(r[o]=e/n[o])})),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,o=t.negativeSampleRate,n=this.optimizationState,i=n.epochsPerSample,s=n.headEmbedding,a=n.tailEmbedding,l=s[0].length,c=s.length===a.length,f=i.map((function(t){return t/o})),m=u([],h(f),!1),g=u([],h(i),!1);this.assignOptimizationStateParameters({epochOfNextSample:g,epochOfNextNegativeSample:m,epochsPerNegativeSample:f,moveOther:c,initialAlpha:r,alpha:r,gamma:e,dim:l})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,o=r.head,n=r.tail,i=r.epochsPerSample,s=this.getNEpochs(),a=this.graph.nCols,h=E(this.spread,this.minDist),u=h.a,l=h.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:o,tail:n,epochsPerSample:i,a:u,b:l,nEpochs:s,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,o=e.tail,n=e.headEmbedding,i=e.tailEmbedding,s=e.epochsPerSample,a=e.epochOfNextSample,h=e.epochOfNextNegativeSample,u=e.epochsPerNegativeSample,l=e.moveOther,c=e.initialAlpha,f=e.alpha,m=e.gamma,g=e.a,d=e.b,w=e.dim,y=e.nEpochs,v=e.nVertices,b=0;b<s.length;b++)if(!(a[b]>t)){var M=r[b],E=o[b],N=n[M],R=i[E],z=S(N,R),k=0;z>0&&(k=-2*g*d*Math.pow(z,d-1),k/=g*Math.pow(z,d)+1);for(var A=0;A<w;A++){var I=x(k*(N[A]-R[A]),4);N[A]+=I*f,l&&(R[A]+=-I*f)}a[b]+=s[b];for(var O=Math.floor((t-h[b])/u[b]),P=0;P<O;P++){var _=p.tauRandInt(v,this.random),C=i[_],T=S(N,C),j=0;if(T>0)j=2*m*d,j/=(.001+T)*(g*Math.pow(T,d)+1);else if(M===_)continue;for(A=0;A<w;A++)I=4,j>0&&(I=x(j*(N[A]-C[A]),4)),N[A]+=I*f}h[b]+=O*u[b]}return e.alpha=c*(1-t/y),e.currentEpoch+=1,n},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise((function(r,o){var n=function(){return s(e,void 0,void 0,(function(){var e,i,s,h,u,l;return a(this,(function(a){try{if(e=this.optimizationState,i=e.nEpochs,s=e.currentEpoch,this.embedding=this.optimizeLayoutStep(s),h=this.optimizationState.currentEpoch,u=!1===t(h),l=h===i,u||l)return[2,r(l)];setTimeout((function(){return n()}),0)}catch(t){o(t)}return[2]}))}))};setTimeout((function(){return n()}),0)}))},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var o=this.optimizationState,n=o.nEpochs,i=o.currentEpoch;r=this.optimizeLayoutStep(i);var s=this.optimizationState.currentEpoch,a=!1===t(s);e=s===n||a}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t.prototype.setParameters=function(t){this.learningRate=t.learningRate,this.localConnectivity=t.localConnectivity,this.minDist=t.minDist,this.nComponents=t.nComponents,this.nEpochs=t.nEpochs,this.nNeighbors=t.nNeighbors,this.negativeSampleRate=t.negativeSampleRate,this.repulsionStrength=t.repulsionStrength,this.setOpMixRatio=t.setOpMixRatio,this.spread=t.spread,this.transformQueueSize=t.transformQueueSize,this.targetMetric=t.targetMetric,this.targetWeight=t.targetWeight,this.targetNNeighbors=t.targetNNeighbors,this.knnIndices=t.knnIndices,this.knnDistances=t.knnDistances,this.graph=f.SparseMatrix.deserialize(t.graph),this.X=t.X,this.isInitialized=t.isInitialized,this.rpForest=t.rpForest.map(g.FlatTree.deserialize),this.searchGraph=f.SparseMatrix.deserialize(t.searchGraph),this.Y=t.Y,this.embedding=t.embedding,this.optimizationState=M.deserialize(t.optimizationState)},t.prototype.serialize=function(){var t=this,e=t.learningRate,r=t.localConnectivity,o=t.minDist,n=t.nComponents,i=t.nEpochs,s=t.nNeighbors,a=t.negativeSampleRate,h=t.repulsionStrength,u=t.setOpMixRatio,l=t.spread,c=t.transformQueueSize,f=t.targetMetric,m=t.targetWeight,g=t.targetNNeighbors,p=t.knnIndices,d=t.knnDistances,w=t.graph,y=t.X,v=t.isInitialized,b=t.rpForest,M=t.searchGraph,x=t.Y,S=t.embedding,E=t.optimizationState;return{learningRate:e,localConnectivity:r,minDist:o,nComponents:n,nEpochs:i,nNeighbors:s,negativeSampleRate:a,repulsionStrength:h,setOpMixRatio:u,spread:l,transformQueueSize:c,targetMetric:f,targetWeight:m,targetNNeighbors:g,knnIndices:p,knnDistances:d,graph:w.serialize(),X:y,isInitialized:v,rpForest:b.map((function(t){return t.serialize()})),searchGraph:M.serialize(),Y:x,embedding:S,optimizationState:E.serialize()}},t.deserialize=function(e,r){void 0===r&&(r={});var o=new t(r);return o.setParameters(e),o.makeSearchFns(),o},t}();function b(t,e){for(var r=0,o=0;o<t.length;o++)r+=Math.pow(t[o]-e[o],2);return Math.sqrt(r)}e.UMAP=v,e.euclidean=b,e.cosine=function(t,e){for(var r=0,o=0,n=0,i=0;i<t.length;i++)r+=t[i]*e[i],o+=Math.pow(t[i],2),n+=Math.pow(e[i],2);return 0===o&&0===n?0:0===o||0===n?1:1-r/Math.sqrt(o*n)};var M=function(){function t(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0}return t.prototype.serialize=function(){var t=this;return{currentEpoch:t.currentEpoch,headEmbedding:t.headEmbedding,tailEmbedding:t.tailEmbedding,head:t.head,tail:t.tail,epochsPerSample:t.epochsPerSample,epochOfNextSample:t.epochOfNextSample,epochOfNextNegativeSample:t.epochOfNextNegativeSample,epochsPerNegativeSample:t.epochsPerNegativeSample,moveOther:t.moveOther,initialAlpha:t.initialAlpha,alpha:t.alpha,gamma:t.gamma,a:t.a,b:t.b,dim:t.dim,nEpochs:t.nEpochs,nVertices:t.nVertices}},t.deserialize=function(e){var r=new t;return r.currentEpoch=e.currentEpoch,r.headEmbedding=e.headEmbedding,r.tailEmbedding=e.tailEmbedding,r.head=e.head,r.tail=e.tail,r.epochsPerSample=e.epochsPerSample,r.epochOfNextSample=e.epochOfNextSample,r.epochOfNextNegativeSample=e.epochOfNextNegativeSample,r.epochsPerNegativeSample=e.epochsPerNegativeSample,r.moveOther=e.moveOther,r.initialAlpha=e.initialAlpha,r.alpha=e.alpha,r.gamma=e.gamma,r.a=e.a,r.b=e.b,r.dim=e.dim,r.nEpochs=e.nEpochs,r.nVertices=e.nVertices,r},t}();function x(t,e){return t>e?e:t<-e?-e:t}function S(t,e){for(var r=0,o=0;o<t.length;o++)r+=Math.pow(t[o]-e[o],2);return r}function E(t,e){var r=p.linear(0,3*t,300).map((function(t){return t<e?1:t})),o=p.zeros(r.length).map((function(o,n){return r[n]>=e?Math.exp(-(r[n]-e)/t):o})),n={x:r,y:o},i=(0,d.default)(n,(function(t){var e=h(t,2),r=e[0],o=e[1];return function(t){return 1/(1+r*Math.pow(t,2*o))}}),{damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01}).parameterValues,s=h(i,2);return{a:s[0],b:s[1]}}function N(t,e,r,o){return void 0===r&&(r=1),void 0===o&&(o=5),t.map((function(t,n,i){return-1===e[n]||-1===e[i]?t*Math.exp(-r):e[n]!==e[i]?t*Math.exp(-o):t}))}function R(t){t=f.normalize(t,"max");var e=f.transpose(t),r=f.pairwiseMultiply(e,t);return t=f.add(t,f.subtract(e,r)),f.eliminateZeros(t)}function z(t,e,r){for(var o=p.zeros(t.length).map((function(t){return p.zeros(r[0].length)})),n=0;n<t.length;n++)for(var i=0;i<t[0].length;i++)for(var s=0;s<r[0].length;s++){var a=t[n][i];o[n][s]+=e[n][i]*r[a][s]}return o}e.findABParams=E,e.fastIntersection=N,e.resetLocalConnectivity=R,e.initTransform=z},185:function(t,e){var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function o(t,e){return Math.floor(e()*t)}function n(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function i(t,e){return n(t).map((function(){return e}))}function s(t){return i(t,0)}function a(t){return t.reduce((function(t,e){return t+e}))}Object.defineProperty(e,"__esModule",{value:!0}),e.reshape2d=e.rejectionSample=e.max2d=e.max=e.mean=e.sum=e.linear=e.ones=e.zeros=e.filled=e.range=e.empty=e.norm=e.tauRand=e.tauRandInt=void 0,e.tauRandInt=o,e.tauRand=function(t){return t()},e.norm=function(t){var e,o,n=0;try{for(var i=r(t),s=i.next();!s.done;s=i.next()){var a=s.value;n+=Math.pow(a,2)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(e)throw e.error}}return Math.sqrt(n)},e.empty=n,e.range=function(t){return n(t).map((function(t,e){return e}))},e.filled=i,e.zeros=s,e.ones=function(t){return i(t,1)},e.linear=function(t,e,r){return n(r).map((function(o,n){return t+n*((e-t)/(r-1))}))},e.sum=a,e.mean=function(t){return a(t)/t.length},e.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},e.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++)e=t[r][o]>e?t[r][o]:e;return e},e.rejectionSample=function(t,e,r){for(var n=s(t),i=0;i<t;i++)for(var a=!0;a;){for(var h=o(e,r),u=!1,l=0;l<i;l++)if(h===n[l]){u=!0;break}u||(a=!1),n[i]=h}return n},e.reshape2d=function(t,e,r){var o=[],n=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var i=0;i<e;i++){for(var s=[],a=0;a<r;a++)s.push(t[n]),n+=1;o.push(s)}return o}}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,r),i.exports}r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(()=>{var t=o;Object.defineProperty(t,"__esModule",{value:!0}),t.UMAP=void 0;var e=r(329);Object.defineProperty(t,"UMAP",{enumerable:!0,get:function(){return e.UMAP}})})(),o})()));